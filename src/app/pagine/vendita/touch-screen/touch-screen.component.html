<div class="intest">
  <div class="d-flex justify-content-center">
    <div class="titolo">TOUCH-SCREEN</div>
  </div>
</div>

<!-- Sezione Esistente -->
<section class="sezione1">
  <div class="contInput">
    <input class="form-control myForm" value="Numero" readonly />
    <span class="spazio"></span>
    <input class="form-control myForm" type="number" [(ngModel)]="numero" />

    <span class="spazio"></span>

    <input class="form-control myForm" value="Data" readonly />
    <span class="spazio"></span>
    <input class="form-control formPers2" type="date" [value]="currentDate" />

    <span class="spazio"></span>

    <input class="form-control myForm" value="Orario" readonly />
    <span class="spazio"></span>
    <input class="form-control formPers myForm" type="time" [value]="currentTime" />

    <div class="contInput2">
      <input class="form-control formPers2" value="Codice Lotteria" readonly />
      <span class="spazio"></span>
      <input class="form-control myForm" type="text" id="inputCodice">
      <div class="bordoX">
        <i class="fa-solid fa-x" (click)="resetInput()"></i>
      </div>
    </div>
  </div>
</section>

<!-- Nuova Sezione con Griglia e Pannello Laterale -->
<div class="layout-container">
  <!-- Sidebar delle Categorie -->
  <div class="sidebar">
    <ul>
      <li *ngFor="let categoria of categorie" (click)="selezionaCategoria(categoria)"
        [class.active]="categoria === categoriaSelezionata">
        {{ categoria.nome }}
      </li>
    </ul>
  </div>

  <!-- Griglia Centrale -->
  <div class="grid">
    <div class="header-row">
      <div *ngFor="let tipologia of tipologie" class="header-cell" (click)="selezionaTipologia(tipologia)"
        [class.active]="tipologia === tipologiaSelezionata">
        {{ tipologia }}
      </div>
    </div>


    <!--GRIGLIA-->
    <div class="container text-center">
      <!-- Contenitore con altezza fissa e scroll verticale -->
      <div class="prodotti-scroll">
        <!-- Se è selezionata una tipologia specifica, mostra solo gli articoli filtrati -->
        <ng-container *ngIf="tipologiaSelezionata; else mostraTuttiArticoli">
          <div class="row row-cols-1 row-cols-sm-2 row-cols-md-4">
            <div class="col" *ngFor="let articolo of articoliFiltrati[tipologiaSelezionata] || []"
                 (click)="selezionaArticolo(articolo)">
              <div class="articolo-card p-3 border">
                <h6>{{ articolo.nome }}</h6>
                <p>€{{ articolo.prezzo }}</p>
              </div>
            </div>
          </div>
        </ng-container>

        <!-- Se non è selezionata alcuna tipologia, mostra tutti gli articoli di tutte le tipologie -->
        <ng-template #mostraTuttiArticoli>
          <div class="row row-cols-1 row-cols-sm-2 row-cols-md-4">
            <ng-container *ngFor="let tipologia of tipologie">
              <div class="col" *ngFor="let articolo of articoliFiltrati[tipologia] || []"
                   (click)="selezionaArticolo(articolo)">
                <div class="articolo-card p-3 border">
                  <h6>{{ articolo.nome }}</h6>
                  <p>€{{ articolo.prezzo }}</p>
                </div>
              </div>
            </ng-container>
          </div>
        </ng-template>
      </div>
    </div>






  </div>


  <!-- Sezione della Calcolatrice -->
  <div class="calcolatrice-container">
    <!-- Display principale della calcolatrice -->
    <div class="display">
      <div class="totale-prodotti">
        Totale Prodotti: €{{ calcolaTotaleProdotti() }}
      </div>
      <!-- Tabella dei prodotti selezionati -->
      <div class="prodotti-selezionati" *ngIf="prodottiSelezionati.length > 0">
        <h5>Prodotti Selezionati:</h5>
        <table>
          <thead>
            <tr>
              <th>Nome</th>
              <th>Prezzo</th>
              <th>Quantità</th>
              <th>Totale</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let prodotto of prodottiSelezionati">
              <td>{{ prodotto.articolo.nome }}</td>
              <td>€{{ prodotto.articolo.prezzo }}</td>
              <td>{{ prodotto.quantita }}</td>
              <td>€{{ prodotto.articolo.prezzo * prodotto.quantita }}</td>
            </tr>
          </tbody>
          <tfoot>
            <tr>
              <td colspan="3"><strong>Totale</strong></td>
              <td>€{{ calcolaTotaleProdotti() }}</td>
            </tr>
          </tfoot>
        </table>
      </div>
    </div>

    <!-- Bottoni della calcolatrice -->
    <div class="buttons">
      <button class="btn" (click)="aggiungiNumero('1')">1</button>
      <button class="btn" (click)="aggiungiNumero('2')">2</button>
      <button class="btn" (click)="aggiungiNumero('3')">3</button>
      <button class="btn" (click)="aggiungiOperazione('+')">+</button>
      <button class="btn" (click)="aggiungiNumero('4')">4</button>
      <button class="btn" (click)="aggiungiNumero('5')">5</button>
      <button class="btn" (click)="aggiungiNumero('6')">6</button>
      <button class="btn" (click)="aggiungiOperazione('-')">-</button>
      <button class="btn" (click)="aggiungiNumero('7')">7</button>
      <button class="btn" (click)="aggiungiNumero('8')">8</button>
      <button class="btn" (click)="aggiungiNumero('9')">9</button>
      <button class="btn" (click)="aggiungiOperazione('*')">x</button>
      <button class="btn" (click)="aggiungiNumero('0')">0</button>
      <button class="btn" (click)="aggiungiOperazione('/')">/</button>
      <button class="btn uguale" (click)="calcola()">=</button>
      <button class="btn reset" (click)="reset()">C</button>
      <button class="btn" (click)="aggiungiIva()">+IVA</button>
      <button class="btn" (click)="rimuoviIva()">-IVA</button>
      <button class="btn" (click)="applicaSconto()">Sconto%</button>
      <button class="btn" (click)="totale()">Totale</button>
    </div>

    <!-- Sezione pagamento -->
    <div class="pagamento">
      <label for="pagaContanti">Contanti: </label>
      <input type="number" id="pagaContanti" placeholder="Inserisci importo" [(ngModel)]="importoPagamento">
      <button class="btn" (click)="calcolaResto()">Calcola Resto</button>
    </div>

    <!-- Display del resto -->
    <div class="resto-display">
      Resto: <span id="resto">{{ resto || '0' }}</span>
    </div>
  </div>






</div>
